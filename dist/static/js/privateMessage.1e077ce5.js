"use strict";(self["webpackChunkwangyiyun_app"]=self["webpackChunkwangyiyun_app"]||[]).push([[458],{5894:function(e,t,s){s.r(t),s.d(t,{default:function(){return Q}});var n=s(8551),o=s(9812),a=s(4220),l=s(5109),i=s(102),r=s(6183),c=s(9207);const[u,d]=(0,l["do"])("tag"),p={size:String,mark:Boolean,show:i.J5,type:(0,i.SQ)("default"),color:String,plain:Boolean,round:Boolean,textColor:String,closeable:Boolean};var g=(0,o.aZ)({name:u,props:p,emits:["close"],setup(e,{slots:t,emit:s}){const n=e=>{e.stopPropagation(),s("close",e)},l=()=>e.plain?{color:e.textColor||e.color,borderColor:e.color}:{color:e.textColor,background:e.color},i=()=>{var s;const{type:a,mark:i,plain:u,round:p,size:g,closeable:m}=e,v={mark:i,plain:u,round:p};g&&(v[g]=g);const f=m&&(0,o.Wm)(c.JO,{name:"cross",class:[d("close"),r.e9],onClick:n},null);return(0,o.Wm)("span",{style:l(),class:d([v,a])},[null==(s=t.default)?void 0:s.call(t),f])};return()=>(0,o.Wm)(a.uT,{name:e.closeable?"van-fade":void 0},{default:()=>[e.show?i():null]})}});const m=(0,n.n)(g);s(9246),s(7255),s(2069);var v=s(9742),f=(s(3582),s(5893));const h=e=>((0,o.dD)("data-v-b86f64b0"),e=e(),(0,o.Cn)(),e),y={class:"main"},w={class:"topItemLeft",style:{width:"100%",display:"flex","align-items":"center",height:"20px","background-color":"white",position:"fixed","z-index":"10"}},x=h((()=>(0,o._)("use",{"xlink:href":"#icon-fanhui"},null,-1))),k=[x],b=h((()=>(0,o._)("span",{style:{width:"100%",display:"flex","justify-content":"space-evenly","font-size":"large"}},"网易云私信",-1))),C={class:"content"},_=["onClick"],H={class:"inside"},M=["src"],T={class:"text"},S={class:"line1"},z={class:"line2"},D={key:0,class:"count"};function U(e,t,s,n,a,l){const i=v.od,r=m;return(0,o.wg)(),(0,o.iD)("div",y,[(0,o._)("div",w,[((0,o.wg)(),(0,o.iD)("svg",{class:"icon","aria-hidden":"true",onClick:t[0]||(t[0]=t=>e.$router.go(-1))},k)),b]),(0,o._)("div",C,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.message,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:"items",key:t,onClick:t=>l.goPrivateMessageHistory(e)},[(0,o._)("div",H,[(0,o._)("img",{src:e.fromUser.avatarUrl},null,8,M),(0,o._)("div",T,[(0,o._)("div",S,[(0,o._)("p",null,(0,f.zw)(e.fromUser.nickname),1),(0,o._)("p",null,(0,f.zw)(e.lastMsgTime),1)]),(0,o._)("div",z,[(0,o.Wm)(i,{content:e.lastMsg.msg,style:{width:"90%"},rows:"1"},null,8,["content"]),0!=e.newMsgCount?((0,o.wg)(),(0,o.iD)("div",D,[(0,o.Wm)(r,{type:"danger",style:{"border-radius":"50%"}},{default:(0,o.w5)((()=>[(0,o.Uk)((0,f.zw)(e.newMsgCount),1)])),_:2},1024)])):(0,o.kq)("",!0)])])])],8,_)))),128))])])}s(7658);var W=s(5263),I={name:"privateMessage",data(){return{message:[]}},methods:{goPrivateMessageHistory:function(e){this.$router.push({path:"privateMessageHistory",query:{uid:e.fromUser.userId,toUid:e.toUser.userId}})}},created:async function(){this.message=(await(0,W.Hp)()).data.msgs;for(let e=0;e<this.message.length;e++)this.message[e].lastMsg=JSON.parse(this.message[e].lastMsg),this.message[e].lastMsgTime=new Date(this.message[e].lastMsgTime).toLocaleString();console.log(this.message)}},P=s(8998);const B=(0,P.Z)(I,[["render",U],["__scopeId","data-v-b86f64b0"]]);var Q=B},9742:function(e,t,s){s.d(t,{od:function(){return g}});var n=s(8551),o=s(9812),a=s(521),l=s(6635),i=s(5109),r=s(102);const[c,u]=(0,i["do"])("text-ellipsis"),d={rows:(0,r.SI)(1),content:(0,r.SQ)(""),expandText:(0,r.SQ)(""),collapseText:(0,r.SQ)("")};var p=(0,o.aZ)({name:c,props:d,emits:["clickAction"],setup(e,{emit:t}){const s=(0,a.iH)(""),n=(0,a.iH)(!1),i=(0,a.iH)(!1),r=(0,a.iH)(),c=e=>{if(!e)return 0;const t=e.match(/^\d*(\.\d*)?/);return t?Number(t[0]):0},d=()=>{const t=()=>{if(!r.value)return;const t=window.getComputedStyle(r.value),s=document.createElement("div"),n=Array.prototype.slice.apply(t);return n.forEach((e=>{s.style.setProperty(e,t.getPropertyValue(e))})),s.style.position="fixed",s.style.zIndex="-9999",s.style.top="-9999px",s.style.height="auto",s.style.minHeight="auto",s.style.maxHeight="auto",s.innerText=e.content,document.body.appendChild(s),s},n=(t,s)=>{const{content:n,expandText:o}=e,a="...";let l=0,i=n.length,r=-1;while(l<=i){const e=Math.floor((l+i)/2);t.innerText=n.slice(0,e)+a+o,t.offsetHeight<=s?(l=e+1,r=e):i=e-1}return n.slice(0,r)+a},o=t();if(!o)return;const{paddingBottom:a,paddingTop:l,lineHeight:u}=o.style,d=(Number(e.rows)+.5)*c(u)+c(l)+c(a);d<o.offsetHeight?(i.value=!0,s.value=n(o,d)):(i.value=!1,s.value=e.content),document.body.removeChild(o)},p=e=>{n.value=!n.value,t("clickAction",e)},g=()=>(0,o.Wm)("span",{class:u("action"),onClick:p},[n.value?e.collapseText:e.expandText]);return(0,o.bv)(d),(0,o.YP)((()=>[e.content,e.rows]),d),(0,l.OR)("resize",d),()=>(0,o.Wm)("div",{ref:r,class:u()},[n.value?e.content:s.value,i.value?g():null])}});const g=(0,n.n)(p)},3582:function(e,t,s){s(9246)}}]);
//# sourceMappingURL=privateMessage.1e077ce5.js.map